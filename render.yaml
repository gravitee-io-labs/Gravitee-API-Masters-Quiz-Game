services:
  # Backend API (Python FastAPI)
  - type: web
    name: gravitee-quiz-backend
    runtime: docker
    plan: free
    region: frankfurt
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    healthCheckPath: /health
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: gravitee-quiz-db
          property: connectionString
      - key: SECRET_KEY
        generateValue: true
      - key: BASE_PATH
        value: ""
      - key: CORS_ORIGINS
        sync: false
    autoDeploy: true

  # Game Client Frontend
  - type: web
    name: gravitee-quiz-game-client
    runtime: docker
    plan: free
    region: frankfurt
    dockerfilePath: ./game-client/Dockerfile
    dockerContext: .
    envVars:
      - key: API_BASE_URL
        value: https://gravitee-quiz-backend.onrender.com/api
    autoDeploy: true

  # Admin Console Frontend
  - type: web
    name: gravitee-quiz-admin-console
    runtime: docker
    plan: free
    region: frankfurt
    dockerfilePath: ./admin-console/Dockerfile
    dockerContext: .
    envVars:
      - key: API_BASE_URL
        value: https://gravitee-quiz-backend.onrender.com/api
    autoDeploy: true

  # Scoreboard Display
  - type: web
    name: gravitee-quiz-scoreboard
    runtime: docker
    plan: free
    region: frankfurt
    dockerfilePath: ./scoreboard/Dockerfile
    dockerContext: .
    envVars:
      - key: API_BASE_URL
        value: https://gravitee-quiz-backend.onrender.com/api
    autoDeploy: true

databases:
  - name: gravitee-quiz-db
    databaseName: gravitee_quiz
    user: quiz_user
    plan: free
    region: frankfurt
